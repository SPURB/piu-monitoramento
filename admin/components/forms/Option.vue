<template>
  <div class="w-full h-full flex items-center justify-between p-2" :class="isEdit ? 'bg-gray-500' : ''">
    <template v-if="!isEdit">
      <div :class="!inEdit ? 'w-full' : ''" @click="!inEdit ? selected(option) : false">
        {{ option.nome }}
      </div>
      <div v-if="inEdit" @click="isEdit = !isEdit">
        <svg class="h-5 w-5 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M17.414 2.58594C17.0389 2.211 16.5303 2.00037 16 2.00037C15.4697 2.00037 14.9611 2.211 14.586 2.58594L7 10.1719V12.9999H9.828L17.414 5.41394C17.7889 5.03888 17.9996 4.53027 17.9996 3.99994C17.9996 3.46961 17.7889 2.96099 17.414 2.58594Z"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M2 6C2 5.46957 2.21071 4.96086 2.58579 4.58579C2.96086 4.21071 3.46957 4 4 4H8C8.26522 4 8.51957 4.10536 8.70711 4.29289C8.89464 4.48043 9 4.73478 9 5C9 5.26522 8.89464 5.51957 8.70711 5.70711C8.51957 5.89464 8.26522 6 8 6H4V16H14V12C14 11.7348 14.1054 11.4804 14.2929 11.2929C14.4804 11.1054 14.7348 11 15 11C15.2652 11 15.5196 11.1054 15.7071 11.2929C15.8946 11.4804 16 11.7348 16 12V16C16 16.5304 15.7893 17.0391 15.4142 17.4142C15.0391 17.7893 14.5304 18 14 18H4C3.46957 18 2.96086 17.7893 2.58579 17.4142C2.21071 17.0391 2 16.5304 2 16V6Z"
          />
        </svg>
      </div>
    </template>

    <template v-else>
      <div class="w-full flex items-center justify-between">
        <input
          v-model="nome"
          type="text"
          class="appearance-none border rounded w-10/12 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
        >
        <span class="pl-2 w-2/12 text-white flex justify-center" @click.prevent="cancelChange">
          <svg
            class="h-5 w-5 fill-current"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M1 0C1.26522 0 1.51957 0.105357 1.70711 0.292893C1.89464 0.48043 2 0.734784 2 1V3.101C2.83204 2.25227 3.86643 1.62931 5.00574 1.29078C6.14506 0.952259 7.35179 0.909318 8.51228 1.16601C9.67277 1.42269 10.7488 1.97056 11.6391 2.758C12.5294 3.54544 13.2045 4.54654 13.601 5.667C13.6491 5.79176 13.6717 5.92489 13.6674 6.05854C13.6632 6.19218 13.6322 6.32361 13.5763 6.44506C13.5203 6.56651 13.4406 6.67551 13.3418 6.76561C13.243 6.85571 13.1272 6.92508 13.0011 6.96963C12.875 7.01417 12.7413 7.03298 12.6078 7.02494C12.4744 7.0169 12.3439 6.98217 12.224 6.92282C12.1042 6.86346 11.9975 6.78068 11.9103 6.67937C11.823 6.57806 11.7569 6.46029 11.716 6.333C11.4141 5.47982 10.8865 4.72451 10.1892 4.14758C9.49191 3.57064 8.65117 3.19369 7.75656 3.05688C6.86195 2.92008 5.94698 3.02855 5.10916 3.37074C4.27133 3.71293 3.54204 4.27602 2.999 5H6C6.26522 5 6.51957 5.10536 6.70711 5.29289C6.89464 5.48043 7 5.73478 7 6C7 6.26522 6.89464 6.51957 6.70711 6.70711C6.51957 6.89464 6.26522 7 6 7H1C0.734784 7 0.48043 6.89464 0.292893 6.70711C0.105357 6.51957 0 6.26522 0 6V1C0 0.734784 0.105357 0.48043 0.292893 0.292893C0.48043 0.105357 0.734784 0 1 0ZM1.008 9.057C1.13184 9.01326 1.26308 8.99434 1.39422 9.00133C1.52537 9.00831 1.65386 9.04106 1.77235 9.09771C1.89084 9.15435 1.99701 9.23378 2.0848 9.33146C2.17259 9.42914 2.24028 9.54316 2.284 9.667C2.58586 10.5202 3.11355 11.2755 3.81082 11.8524C4.50809 12.4294 5.34883 12.8063 6.24344 12.9431C7.13805 13.0799 8.05302 12.9714 8.89084 12.6293C9.72867 12.2871 10.458 11.724 11.001 11H8C7.73478 11 7.48043 10.8946 7.29289 10.7071C7.10536 10.5196 7 10.2652 7 10C7 9.73478 7.10536 9.48043 7.29289 9.29289C7.48043 9.10536 7.73478 9 8 9H13C13.2652 9 13.5196 9.10536 13.7071 9.29289C13.8946 9.48043 14 9.73478 14 10V15C14 15.2652 13.8946 15.5196 13.7071 15.7071C13.5196 15.8946 13.2652 16 13 16C12.7348 16 12.4804 15.8946 12.2929 15.7071C12.1054 15.5196 12 15.2652 12 15V12.899C11.168 13.7477 10.1336 14.3707 8.99426 14.7092C7.85494 15.0477 6.64821 15.0907 5.48772 14.834C4.32723 14.5773 3.25117 14.0294 2.36091 13.242C1.47065 12.4546 0.795479 11.4535 0.399 10.333C0.35526 10.2092 0.336343 10.0779 0.343327 9.94678C0.350311 9.81563 0.383061 9.68714 0.439706 9.56865C0.496351 9.45016 0.575781 9.34399 0.673461 9.2562C0.771142 9.16841 0.885158 9.10072 1.009 9.057H1.008Z"
            />
          </svg>
        </span>
      </div>
    </template>
  </div>
</template>

<script>
export default {
  name: 'Option',
  props: {
    option: {
      type: Object,
      required: true
    },
    inEdit: {
      type: Boolean,
      required: true
    }
  },
  data: () => {
    return {
      isEdit: false,
      nome: ''
    }
  },
  watch: {
    inEdit (value) {
      if (!value) {
        this.isEdit = false
        this.nome = this.option.nome
      }
    },
    nome (nome) {
      if (nome !== this.option.nome) {
        this.$emit('update', { nome, id: this.option.id })
      }
    }
  },
  created () {
    this.nome = this.option.nome
  },
  methods: {
    selected (option) {
      this.$emit('option', option)
    },
    cancelChange () {
      this.nome = this.option.nome
      this.$emit('remove', { id: this.option.id })
    }
  }
}
</script>

<style>
</style>
